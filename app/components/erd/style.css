@import "tailwindcss";

@theme {
    --inset-shadow-md: inset 0 1px 5px rgba(0, 0, 0, 0.4);
}

.header-btn {
    @apply p-2 rounded-md hover:not-disabled:bg-[#f7dee0] cursor-pointer transition-colors duration-200;
    @apply disabled:cursor-not-allowed disabled:opacity-50;
}

.ai-prompt-btn {
    @apply w-[170px] bg-white flex justify-between items-center;
    @apply border-1 border-[#640D14] rounded-md p-1 outline-none focus:bg-[#f7dee0];
    @apply hover:not-disabled:bg-[#f7dee0] cursor-pointer transition-colors duration-200;
    @apply disabled:cursor-not-allowed disabled:opacity-50;

    .placeholder {
        @apply font-semibold;
    }

    .shortcut {
        @apply text-xs bg-[#640D14] text-white p-0.5 rounded-[2px];
    }
}

.diagram-item-placeholder {
    mask-size: 200% 100%;

    mask-image: linear-gradient(
        130deg,
        rgb(0, 0, 0) 45%,
        rgba(0, 0, 0, 0.6) 70%,
        rgb(0, 0, 0) 95%
    );
    animation: 1s linear 0s infinite normal none running placeholder-wave;
}

@keyframes placeholder-wave {
    100% {
        mask-position: -200% 0%;
    }
}

.sidebar {
    @apply bg-[#fefbfb] text-[#640D14] p-3 border-r border-[#640D14] h-[calc(100vh-57px)];
    @apply flex flex-col;
}

.diagram-categories {
    @apply flex flex-col gap-2 mt-0.5;
    li {
        @apply text-center;
    }
    button {
        @apply p-2 text-left rounded-md text-[#640D14] cursor-pointer transition-colors duration-200;
        @apply disabled:cursor-not-allowed disabled:opacity-50;
        &:hover {
            @apply not-disabled:bg-[#f7dee0];
        }
        &.active {
            @apply bg-[#f7dee0];
        }
    }
}

.diagram-list {
    @apply flex flex-col gap-1 overflow-auto -mb-3 pb-3;
    scrollbar-width: thin;
    scrollbar-color: #640d14 #fefbfb;

    &.has-scrollbar {
        @apply -mr-2.5;
    }
}

.diagram-item {
    @apply px-2 py-1 text-left rounded-md text-[#640D14] hover:bg-[#f7dee0] cursor-pointer transition-colors duration-200;

    &.selected {
        @apply bg-[#f7dee0];

        .diagram-name {
            &:hover,
            &:focus {
                @apply border-1 border-[#640d14] px-[1px] -mt-[1px] -ml-[2px] -mb-[1px] rounded-md;
                @apply outline-none;
            }
        }
    }

    .diagram-name-form {
        input {
            @apply border-1 border-[#640D14] rounded-md px-[1px] -mt-[1px] -ml-[2px] -mb-[1px] w-full outline-none bg-[#fefbfb];
            @apply disabled:bg-gray-100 disabled:cursor-not-allowed;
        }
    }
}

.feedback-toast {
    @apply fixed px-6 py-3 rounded-full bg-[#640D14] text-white bottom-3;
    @apply left-1/2 -translate-x-1/2;
    @apply hidden gap-2 items-center;

    &.show {
        @apply flex animate-[slideUp_0.3s_linear_forwards];
    }

    &.hide {
        @apply flex animate-[slideDown_0.3s_linear_forwards];
    }
}

.tooltip {
    @apply absolute bg-black text-white rounded-md py-1 px-2 z-1 whitespace-nowrap text-sm;
    &.top {
        @apply -translate-x-1/2 -translate-y-full;
        @apply left-1/2 -top-2;
    }
    &.bottom {
        @apply -translate-x-1/2 translate-y-full;
        @apply left-1/2 -bottom-2;
    }
    &.left {
        @apply -translate-x-full -translate-y-1/2;
        @apply -left-2 top-1/2;
    }
    &.right {
        @apply translate-x-full -translate-y-1/2;
        @apply -right-2 top-1/2;
    }

    &:not(.hidden) {
        @apply flex animate-[fadeIn_0.3s_linear_forwards];
    }
}

@keyframes slideDown {
    0% {
        opacity: 100%;
        transform: translateY(0);
    }
    100% {
        opacity: 0;
        transform: translateY(20px);
        display: none;
    }
}

.theme-menu {
    @apply absolute top-full right-0 z-1 transition duration-300 overflow-hidden opacity-0;
    @apply hidden flex-col gap-3 p-2 border border-[#640d14] bg-[#fefbfb];
    @apply font-medium;

    &.open {
        @apply flex animate-[fadeIn_0.3s_linear_forwards];
    }

    label {
        @apply flex items-center gap-2 px-2 py-1 rounded-md;
        @apply hover:bg-[#f7dee0] cursor-pointer transition-colors duration-200;

        &.selected {
            @apply bg-[#f7dee0];
        }
    }

    input[type="radio"] {
        @apply hidden;
    }
}

.settings-menu {
    @apply absolute top-full right-0 z-1 transition duration-3000 overflow-hidden opacity-0;
    @apply hidden flex-col gap-2 p-2 border border-[#640d14] bg-[#fefbfb];
    @apply font-medium;

    &.open {
        @apply flex animate-[fadeIn_0.3s_linear_forwards];
    }

    .menu-header {
        @apply flex gap-2 items-center px-2 py-1;
    }

    hr {
        @apply w-[calc(100%_+_2_*_8px)] -ml-2;
    }

    .menu-list {
        li {
            button {
                @apply flex gap-2 items-center px-2 py-1 rounded-md text-nowrap w-full;
                @apply hover:bg-[#f7dee0] cursor-pointer transition-colors duration-200;
            }
        }
    }
}

.react-flow-container {
    &.entity {
        .react-flow__pane {
            cursor: url("/entity-cursor.png") 16 16, default;
        }
    }

    &.edge {
        .react-flow__pane {
            cursor: url("/edge-cursor.png") 16 16, default;
        }

        .entity-node {
            .react-flow__handle {
                &.target {
                    @apply top-1/2 pointer-events-none opacity-0;
                }

                &.source {
                    @apply border-none rounded-none w-full h-full transform-none left-0 top-0 bg-transparent;
                }
            }
        }
    }

    &.selector {
        .react-flow__node-entity {
            &.selected {
                .entity-node {
                    .react-flow__resize-control {
                        @apply block;
                    }
                }
            }

            &:hover:not(.selected),
            &.hovered:not(.selected) {
                @apply border-blue-400;

                .entity-node .title {
                    @apply border-blue-400;
                }

                .attributes {
                    li.connected {
                        @apply bg-(--color-blue-400) text-white;
                    }
                }
            }
        }

        .react-flow__edge-erd-edge {
            &:not(.selected) {
                &:hover,
                &.hovered {
                    path {
                        @apply stroke-(--color-blue-400)!;
                    }
                }
            }
        }
    }

    &.selector,
    &.entity {
        .entity-node {
            .react-flow__handle {
                @apply invisible;
            }
        }
    }
}

.erd-items {
    @apply flex flex-col gap-2 cursor-default;

    button {
        @apply p-1 rounded-sm cursor-pointer hover:not-disabled:bg-gray-100 transition-colors duration-300;
        @apply disabled:cursor-not-allowed disabled:opacity-50;
    }
}

.screen-mode-panel {
    @apply select-none rounded-sm overflow-hidden h-[32px];
    @apply hover:bg-gray-100 transition-colors duration-300;

    button {
        @apply p-1 cursor-pointer;
    }
}

.react-flow__node-entity {
    @apply border border-gray-800 bg-white;

    &.selected {
        @apply shadow-md border-blue-600;

        .entity-node {
            .title {
                @apply border-blue-600;
            }

            .attributes {
                li.connected {
                    @apply bg-(--color-blue-600) text-white;
                }
            }
        }
    }

    .react-flow__resize-control {
        @apply hidden;

        .line {
            @apply border-blue-600;
        }

        .handle {
            @apply bg-blue-600;
        }
    }
}

.react-flow__edge-erd-edge {
    &.selected {
        path {
            @apply stroke-(--color-blue-600)!;
        }
    }

    path {
        @apply stroke-(--color-black) stroke-1;
    }
}

.entity-node {
    @apply text-[12px] h-full flex flex-col min-w-[199px] min-h-[99px];

    &.suggested {
        @apply opacity-60 brightness-50 text-gray-700;
    }

    .title {
        @apply font-semibold border-b text-center flex items-center;

        .drag-handle {
            @apply flex items-center relative z-1 p-1 pr-0 w-[24px];
        }

        .name {
            @apply flex-1 p-1 text-left cursor-default;
        }
    }

    .attributes {
        @apply text-[12px] text-gray-600 flex flex-col gap-1 p-2 cursor-default flex-1;

        li {
            @apply -mx-2 px-2 transition-colors duration-200;
            &:hover,
            .hover {
                @apply bg-(--color-blue-400) text-white;
            }

            &.suggested {
                @apply opacity-60 brightness-50 text-gray-700;
            }
        }
    }
}

.erd-connection-line {
    @apply stroke-(--color-black);
}

.edge-label {
    @apply absolute bg-gray-700/5 backdrop-blur-xs text-xs text-gray-800 cursor-pointer pointer-events-auto;

    button {
        @apply bg-transparent border-none hover:bg-gray-700/7 px-1 py-0.5 h-5;
    }

    select {
        @apply outline-1 -outline-offset-1 bg-gray-50 hover:bg-gray-100 px-1 py-0.5 h-5 w-12 appearance-none;
    }
}

.entity-info {
    @apply flex flex-col h-full;

    button {
        @apply transition-colors duration-300 cursor-pointer font-medium rounded-md;
    }

    .error {
        @apply text-sm text-[#800E13] font-medium;
    }

    .details {
        @apply flex-1 h-full flex flex-col text-[#640D14];

        ul {
            li {
                &:last-child {
                    @apply mt-2;
                }
            }
        }

        .attribute-form {
            scrollbar-width: thin;
            scrollbar-color: #640d14 #fefbfb;
            @apply flex flex-col border-t border-gray-400 gap-2 relative;
            @apply -ml-3 pl-3 mt-3 pr-3 py-3 -mr-3;
            @apply overflow-y-auto overflow-x-hidden h-full;

            &.with-scrollbar {
                @apply py-0 pr-2;

                &::before,
                &::after {
                    @apply content-[""] sticky h-3 min-h-3 -ml-3 w-[calc(100%+var(--spacing)*5)];
                }
                &::before {
                    @apply top-0 -mb-2;
                    background-image: linear-gradient(
                        rgb(56 4 14 / 20%),
                        transparent
                    );
                }
                &::after {
                    @apply bottom-0 -mt-2;
                    background-image: linear-gradient(
                        0,
                        rgb(56 4 14 / 20%),
                        transparent
                    );
                }
            }
        }

        .edit-attribute-btn {
            @apply p-2 flex items-center justify-self-end;
            @apply bg-[#335c67] hover:bg-[#2a4c55] text-white;
        }

        .remove-attribute-btn {
            @apply p-2 flex items-center justify-self-end;
            @apply bg-[#640D14] hover:bg-[#44090e] text-white;
        }

        .add-attribute-btn {
            @apply p-2 flex gap-1 items-center justify-self-end;
            @apply bg-[#003049] hover:bg-[#000305] text-white;
        }
    }

    .actions {
        @apply flex justify-between mt-3;

        .back-btn {
            @apply flex gap-2 py-2 px-2.5 border-1 items-center;
            @apply bg-[#003049] hover:bg-[#000305] text-white font-semibold;

            svg {
                @apply -ml-[7.5px];
            }
        }
        .submit-btn {
            @apply flex gap-2 py-2 px-2.5 border-1 items-center;
            @apply bg-[#AD2831] hover:bg-[#800E13] text-white font-semibold;

            svg {
                @apply -ml-[3.34px];
            }
        }
    }
}

.edge-info {
    @apply flex flex-col h-full;

    button {
        @apply transition-colors duration-300 cursor-pointer font-medium rounded-md;
    }

    .details {
        @apply flex-1 h-full flex flex-col text-[#640D14];

        .edge-form {
            scrollbar-width: thin;
            scrollbar-color: #640d14 #fefbfb;
            @apply flex flex-col gap-2 relative;
            @apply overflow-y-auto overflow-x-hidden h-full;
        }
    }
}

.resize-handle {
    &::before,
    &::after {
        @apply content-[""] absolute top-1/2 -translate-y-1/2 w-[1px] h-15 bg-gray-400;
    }
    &::before {
        @apply right-[2.5px];
    }
    &::after {
        @apply right-[0];
    }
}

.input-field {
    @apply flex flex-col;

    label {
        @apply font-medium;
    }

    input {
        @apply border-1 border-gray-400 bg-white text-black p-1 rounded-md;
        @apply disabled:bg-gray-100 disabled:cursor-not-allowed;
    }

    .required {
        @apply text-[#640D14] ml-0.5;
    }
}

.text-area-field {
    @apply flex flex-col;

    label {
        @apply font-medium;
    }

    textarea {
        @apply border-1 border-gray-400 bg-white text-black p-2 rounded-md;
        @apply focus:outline-[#640D14];
    }

    .required {
        @apply text-[#640D14] ml-0.5;
    }
}

.radio-field,
.checkbox-field {
    @apply flex gap-2;

    label {
        @apply font-medium;
    }

    input {
        @apply p-2 disabled:cursor-not-allowed;
    }
}

.select-field {
    @apply flex flex-col;

    label {
        @apply font-medium;
    }

    select {
        @apply border-1 border-gray-400 bg-white text-black p-1 rounded-md appearance-none;
    }
}

.export-options {
    .radio-field,
    .checkbox-field {
        @apply flex-row-reverse justify-end;
    }
}

.feedback-form {
    .input-field {
        @apply w-full;
    }

    .text-area-field {
        @apply w-full;
    }
}

.auth-header {
    @apply flex rounded-t-md justify-around font-medium mb-4 overflow-hidden;
    li {
        @apply flex-1 hover:bg-[#fce8ea] border-b border-[#640d14];
        @apply flex justify-center;
        @apply transition-colors duration-300;
        &.active {
            @apply border-b-2 bg-[#640d14] text-white font-semibold;
        }
        button {
            @apply p-4 cursor-pointer flex-1;
        }
    }
}

.auth-btn {
    @apply flex gap-2 py-2 px-2.5 border-1 items-center w-fit self-end;
    @apply bg-[#640d14] hover:not-disabled:bg-[#44090e] text-white font-semibold;
    @apply transition-colors duration-300 cursor-pointer font-medium rounded-md;
    @apply disabled:cursor-not-allowed disabled:opacity-50;
}

.auth-body {
    form {
        @apply hidden;
        &.active {
            @apply flex;
        }
    }
}

.modal-container {
    @apply hidden opacity-0 perspective-normal transform-3d;
    @apply fixed h-screen w-full z-1 bg-black/50;

    .modal-content {
        @apply bg-[#fefbfb] text-[#640D14] rounded-md w-[min(500px,_90vw)];
        @apply absolute top-[10vw] left-1/2 -translate-x-1/2 transform-[translateY(20px)] opacity-0;
        @apply max-h-[calc(80vw)];

        &.export-diagram {
            @apply w-[min(1024px,_90vw)] top-[57px] max-h-[calc(100vh-2*57px)] overflow-y-auto overflow-x-hidden;
            scrollbar-width: thin;
            scrollbar-color: #640d14 #fefbfb;

            &.has-scrollbar {
                @apply -mr-2.5;
            }
        }
    }

    &.open {
        @apply block animate-[fadeIn_0.2s_linear_forwards];

        .modal-content {
            animation: slideUp 0.3s ease-in forwards;
        }
    }

    .action-btns {
        @apply flex justify-around w-full mt-4;
    }

    button {
        &.link {
            @apply underline cursor-pointer hover:text-[#44090e];
        }

        &.close-modal {
            @apply absolute top-2 right-2 outline-2 outline-[#fefbfb] -outline-offset-2;
            @apply p-2 rounded-md text-[#640D14] cursor-pointer transition-colors duration-200;
            &:hover {
                @apply not-disabled:bg-[#f7dee0] not-disabled:outline-[#f7dee0];
            }
            &:focus {
                @apply outline-[#44090e];
            }
        }

        &.cancel-btn,
        &.confirm-btn {
            @apply px-5 py-2 rounded-md font-semibold cursor-pointer transition-all duration-200;
            @apply disabled:opacity-50 disabled:cursor-not-allowed;
        }

        &.cancel-btn {
            @apply text-[#44090e] bg-[#f7dee0] outline-2 outline-[#f7dee0] -outline-offset-2;
            &:hover {
                @apply not-disabled:bg-[#fbeff0] not-disabled:outline-[#fbeff0];
            }
            &:focus {
                @apply outline-[#44090e];
            }
        }

        &.confirm-btn {
            @apply text-white bg-[#640D14] outline-2 outline-[#640D14] -outline-offset-2;
            &:hover {
                @apply not-disabled:bg-[#44090e] not-disabled:outline-[#44090e];
            }
            &:focus {
                @apply outline-[#f7dee0];
            }
        }

        &.highlighter-btn {
            @apply p-1 rounded-[2px] cursor-pointer hover:bg-[#fce8ea] duration-200 transition-colors;
        }
    }

    .server-error-message {
        @apply flex gap-2 items-center border rounded-md p-3 text-white bg-[#640D14];
    }
}

.export-db,
.generate-db {
    @apply border-1 rounded-[2px] border-gray-300;

    &.collapsed {
        @apply max-h-[200px] overflow-hidden;

        &::after {
            content: "";
            position: absolute;
            width: 100%;
            height: 30px;
            bottom: 0;
            background-image: linear-gradient(
                to top,
                var(--color-gray-700),
                transparent
            );
        }
    }
}

@keyframes fadeIn {
    0% {
        opacity: 0;
    }
    100% {
        opacity: 100%;
    }
}

@keyframes slideUp {
    0% {
        opacity: 0;
        transform: translateY(20px);
    }
    100% {
        opacity: 100%;
        transform: translateY(0);
    }
}

.confirmation-input-container {
    @apply flex flex-col gap-2.5 mt-3.5 px-9;

    .confirmation-input {
        @apply flex gap-3.5 justify-between;

        input {
            @apply size-12 text-center border rounded-md focus:ring-2 focus:outline-none;
            @apply transition-all duration-200;
        }

        .error-message {
            @apply text-center;
        }
    }
}
